<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Admin â€“ Portfolio</title>
<link rel="stylesheet" href="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.css">
</head>
 

<body>
<script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
   <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
<script>
  // Ouvrir le widget automatiquement si on vient d'un lien d'invitation / reset
  const hasIdentityToken =
    location.hash.includes('invite_token') ||
    location.hash.includes('recovery_token') ||
    location.search.includes('confirmation_token');

  if (window.netlifyIdentity) {
    // Quand l'utilisateur se connecte, rester dans l'admin
    netlifyIdentity.on('login', () => {
      if (location.pathname !== '/admin/') location.replace('/admin/');
    });

    // Si on arrive d'un email d'invitation / reset, ouvrir le widget
    if (hasIdentityToken) netlifyIdentity.open('login');
  }
</script>
</body>
</html>
